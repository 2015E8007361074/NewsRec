==README

		Author:ieeflsyu
		Date:20151229

国科大 网络数据挖掘大作业 新闻推荐系统
-----------------------------------

### 数据集描述
从国内某著名财经新闻网站―财新网随机选取了10000名用户，并抽取了这10000名用户在2014年3月的所有新闻浏览记录，每条记录包括用户编号、新闻编号、浏览时间（精确到秒）以及新闻文本内容，其中用户编号已做匿名化处理，防止暴露用户隐私。

### 数据格式说明如下：

用户编号	\t新闻编号\t浏览时间\t新闻标题\t新闻详细内容\t新闻发表时间

文本编码utf8
==END


### 基本解题思路

由于起初现在本地单机运行所以先抽取1000名用户数据采用KNN算法进行训练模型<br>

####数据格式为：

用户编号,新闻编号,新闻标题<br>

(下面是部分记录)

		5218791,100648598,消失前的马航370
		5218791,100648802,马航代表与乘客家属见面
		5218791,100648830,马航召开新闻发布会通报失联航班最新情况
		5218791,100648915,马航失联航班搜救画面
		5218791,100648984,马来西亚民航局举行新闻发布会破“舷窗”谣言
		5218791,100649040,NASA发布疑似马航航班失事地点高清地图
		52550,100644102,贵阳一辆公交车起火燃烧已造成6人死亡
		52550,100644648,记者街头“摔倒”测试路人管不管
		52550,100643974,解密中国富裕家庭：也靠工资也贷款
		52550,100643946,银行反击大战余额宝
		52550,100644648,记者街头“摔倒”测试路人管不管
		8936831,100656369,江苏一银行被传倒闭引挤兑潮
		8936831,100656551,马交通部称飞机已经跌入海底
		8936831,100656616,米歇尔成都与学生一起上英语课
		8936831,100656637,探访国际海事卫星组织英国总部
		8936831,100656815,青岛公交司机练武防身
		8936831,100657146,法国卫星发现122个疑似碎片
		8936831,100657176,广西警方摧毁特大贩毒网络
		8936831,100657188,彭丽媛法国看望患病儿童
		8936831,100657261,兰州火车站前被扔砖块
		8936831,100651212,汉龙前高管肖辉申请香港庇护
		1698962,100655181,鲁昕：600多所本科院校转做职业教育
		1698962,100658325,中央巡视组要求广东复查茂名窝案
		....

将抽取到的数据输出到data_1000.txt文件中，然后对data_1000.txt文件中的数据采用开源结巴分词器作分词处理<br>
将分词后的数据输出到cut_data_1000.txt文件中<br>
结巴命令行分词：python -m jieba data_1000.txt > cut_data_1000.txt<br>
(下面是部分记录)<br>

		5218791 / , / 100648598 / , / 消失 / 前 / 的 / 马航 / 370
		5218791 / , / 100648802 / , / 马航 / 代表 / 与 / 乘客 / 家属 / 见面
		5218791 / , / 100648830 / , / 马航 / 召开 / 新闻 / 发布会 / 通报 / 失联 / 航班 / 最新 / 情况
		5218791 / , / 100648915 / , / 马航 / 失联 / 航班 / 搜救 / 画面
		5218791 / , / 100648984 / , / 马来西亚 / 民航局 / 举行 / 新闻 / 发布会 / 破 / “ / 舷窗 / ” / 谣言
		5218791 / , / 100649040 / , / NASA / 发布 / 疑似 / 马航 / 航班 / 失事 / 地点 / 高清 / 地图
		52550 / , / 100644102 / , / 贵阳 / 一辆 / 公交车 / 起火燃烧 / 已 / 造成 / 6 / 人 / 死亡
		52550 / , / 100644648 / , / 记者 / 街头 / “ / 摔倒 / ” / 测试 / 路人管 / 不管
		52550 / , / 100643974 / , / 解密 / 中国 / 富裕 / 家庭 / ： / 也 / 靠 / 工资 / 也 / 贷款
		52550 / , / 100643946 / , / 银行 / 反击 / 大战 / 余额 / 宝
		52550 / , / 100644648 / , / 记者 / 街头 / “ / 摔倒 / ” / 测试 / 路人管 / 不管
		8936831 / , / 100656369 / , / 江苏 / 一 / 银行 / 被 / 传 / 倒闭 / 引 / 挤兑 / 潮
		8936831 / , / 100656551 / , / 马 / 交通部 / 称 / 飞机 / 已经 / 跌入 / 海底
		8936831 / , / 100656616 / , / 米歇尔 / 成都 / 与 / 学生 / 一起 / 上 / 英语课
		8936831 / , / 100656637 / , / 探访 / 国际海事卫星组织 / 英国 / 总部
		8936831 / , / 100656815 / , / 青岛 / 公交 / 司机 / 练武 / 防身
		8936831 / , / 100657146 / , / 法国 / 卫星 / 发现 / 122 / 个 / 疑似 / 碎片
		8936831 / , / 100657176 / , / 广西 / 警方 / 摧毁 / 特大 / 贩毒 / 网络
		8936831 / , / 100657188 / , / 彭丽媛 / 法国 / 看望 / 患病 / 儿童
		8936831 / , / 100657261 / , / 兰州 / 火车站 / 前 / 被 / 扔 / 砖块
		8936831 / , / 100651212 / , / 汉龙前 / 高管 / 肖辉 / 申请 / 香港 / 庇护
		1698962 / , / 100655181 / , / 鲁昕 / ： / 600 / 多所 / 本科 / 院校 / 转做 / 职业 / 教育
		1698962 / , / 100658325 / , / 中央 / 巡视组 / 要求 / 广东 / 复查 / 茂名 / 窝案
		...

然后再对于上面的用浏览新闻记录，根据用户所浏览新闻的标题（以后可以扩展为内容）分词后的主题词计算不同用户间的距离distance，进而根据此距离采用KNN算法对这1000个用户进行聚类。<br>

#####KNN算法步骤

		1. 准备数据，对数据进行预处理
		2. 选用合适的数据结构存储训练数据和测试元组
		3. 设定参数，如k
		4.维护一个大小为k的的按距离由大到小的优先级队列，用于存储最近邻训练元组。随机从训练元组中选取k个元组作为初始的最近邻元组，分别计算测试元组到这k个元组的距离，将训练元组标号和距离存入优先级队列
		5. 遍历训练元组集，计算当前训练元组与测试元组的距离，将所得距离L 与优先级队列中的最大距离Lmax
		6. 进行比较。若L>=Lmax，则舍弃该元组，遍历下一个元组。若L < Lmax，删除优先级队列中最大距离的元组，将当前训练元组存入优先级队列。
		7. 遍历完毕，计算优先级队列中k 个元组的多数类，并将其作为测试元组的类别。
		8. 测试元组集测试完毕后计算误差率，继续设定不同的k值重新进行训练，最后取误差率最小的k 值。

####KNN算法优点

		1.简单，易于理解，易于实现，无需估计参数，无需训练；
		2. 适合对稀有事件进行分类；
		3.特别适合于多分类问题(multi-modal,对象具有多个类别标签)， kNN比SVM的表现要好。

KNN 算法的实现见knn文件夹，里面实现了对数据求K近邻的功能


###基于Jaccard系数简易新闻推荐系统的实现

<b><i>由于用户比较多，下面我用Ruby基于Jaccard系数对于某一用户的历史浏览记录进行训练，然后输入N条新闻，对这N条新闻进行推荐概率计算并排序，进而确认需要推荐那些新闻给该用户。</i></b>

Jaccard 系数是由植物学家 Paul Jaccard 提出的，是用来体现样本相似性和差异性的数值。

###运作原理

取出当前的 item（比如博客文章）和能够很好地描述它的属性（标签、分类或单词）。然后对其它每个 item 计算出它们交集和并集的商。数学过程可以表述为以下公式。

![](https://upload.wikimedia.org/math/1/8/6/186c7f4e83da32e889d606140fae25a0.png)

该方程的计算结果在 0 到 1 之间。你也能够方便地用以下公式来计算项目间的差异性。

![](https://upload.wikimedia.org/math/0/2/9/02906c47e0a08707ad6e35a6c34a43b4.png)

#推荐效果如下：

假如用户看了一条新闻，标题是：

		消失 / 前 / 的 / 马航 / 370

现在有下面几个新闻列表：

		消失 / 前 / 的 / 马航 / 370
		马航 / 代表 / 与 / 乘客 / 家属 / 见面
		马航 / 召开 / 新闻 / 发布会 / 通报 / 失联 / 航班 / 最新 / 情况
		马航 / 失联 / 航班 / 搜救 / 画面
		广西 / 警方 / 摧毁 / 特大 / 贩毒 / 网络
		NASA / 发布 / 疑似 / 马航 / 航班 / 失事 / 地点 / 高清 / 地图

经过我们的推荐系统可以达到如下效果：

		消失 / 前 / 的 / 马航 / 370(1.00)
		马航 / 失联 / 航班 / 搜救 / 画面(0.11)
		马航 / 代表 / 与 / 乘客 / 家属 / 见面(0.10)
		马航 / 召开 / 新闻 / 发布会 / 通报 / 失联 / 航班 / 最新 / 情况(0.08)
		NASA / 发布 / 疑似 / 马航 / 航班 / 失事 / 地点 / 高清 / 地图(0.08)
		广西 / 警方 / 摧毁 / 特大 / 贩毒 / 网络(0.00)
		
其中相似度为1的话，表示同一条新闻，不推荐给用户。剩下的新闻按照推荐概率排序，推荐前N条新闻给用户~